"0","# Calculate distance from each vulnerable tract centroid to nearest hospital"
"0","vulnerable_tract_centroids <- vulnerable_tracts_projected %>%"
"0","  st_centroid()"
"0",""
"0","vulnerable_distances <- st_distance(vulnerable_tract_centroids, hospitals_projected)"
"0",""
"0","vulnerable_tracts_projected <- vulnerable_tracts_projected %>%"
"0","  mutate("
"0","    dist_to_hospital_ft = as.numeric(apply(vulnerable_distances, 1, min)),"
"0","    dist_to_hospital_mi = dist_to_hospital_ft / 5280"
"0","  )"
"0",""
"0","# Summary statistics"
"0","avg_distance <- mean(vulnerable_tracts_projected$dist_to_hospital_mi, na.rm = TRUE)"
"0","print(paste(""Average distance to nearest hospital:"", round(avg_distance, 2), ""miles""))"
"1","[1]"
"1"," ""Average distance to nearest hospital: 4.97 miles"""
"1","
"
"0","max_distance <- max(vulnerable_tracts_projected$dist_to_hospital_mi, na.rm = TRUE)"
"0","print(paste(""Maximum distance:"", round(max_distance, 2), ""miles""))"
"1","[1]"
"1"," ""Maximum distance: 19.16 miles"""
"1","
"
"0","far_tracts <- sum(vulnerable_tracts_projected$dist_to_hospital_mi > 15, na.rm = TRUE)"
"0","print(paste(""Vulnerable tracts more than 15 miles from hospital:"", far_tracts))"
"1","[1]"
"1"," ""Vulnerable tracts more than 15 miles from hospital: 10"""
"1","
"
